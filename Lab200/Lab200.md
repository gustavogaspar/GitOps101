# Crear Build job

Este es el primer trabajo de automatización que creará, en este laboratorio importaremos su código al proyecto y también crearemos su primera imagen de contenedor.

## Crear los archivos de la aplicación Python
En este paso, agregará un código de Python a su repositorio recién creado.

1. Acceda a la consola de **Visual Builder Studio**

2. En la barra izquierda, haga clic en **Organización** , luego haga clic en **Proyectos**.

3. Seleccione el proyecto creado en [Lab100](../Lab100/Lab100.md)

4. En la barra izquierda, selecciona **Git**

5. Haga clic en **+ Archivo** en el lado derecho de la página.

6. Rellene con la siguiente información:
    - *Nombre*: main.py
    - *Contenido*: copie el siguiente código - [main.py](./src/main.py)

![](./img/Build01.PNG)
_ACERCA DEL CÓDIGO: Este código crea un backend de Python, que responde un mensaje de texto cuando se llama al servidor en el puerto 5000._

7. Haga clic en **Confirmar** en el lado derecho de la página, luego haga clic en **Confirmar** en la ventana emergente

8. En la barra izquierda, selecciona Git

9. Haga clic en + Archivo en el lado derecho de la página.

10. Rellene con la siguiente información:
    - *Nombre*: requirements.txt
    - *Contenido*: Copie el siguiente codigo - [requirements.txt](./src/requirements.txt)

![](./img/Build02.PNG)
_ACERCA DEL CÓDIGO: El archivo require.txt enumera las bibliotecas necesarias para que se ejecute la aplicación python_

11. Haga clic en **Confirmar** en el lado derecho de la página, luego haga clic en **Confirmar** en la up window

## Crear el archivo Dockerfile
En este paso, agregará un archivo acoplable a su repositorio. El dockerfile es una representación declarativa de su contenedor y sus características.

1. En la barra izquierda, selecciona **Git**

2. Haga clic en **+ Archivo** en el lado derecho de la página.

3. Rellene con la siguiente información:
    - *Nombre*: Dockerfile 
    - *Contenido*: Copiar el siguiente enlace - [Dockerfile](./src/Dockerfile)

![](./img/Build03.PNG)
_ACERCA DEL CÓDIGO: este dockerfile utiliza una [Imagen Oficial de python](https://hub.docker.com/_/python) como base para crear una nueva imagen que contiene los archivos de la aplicación y las bibliotecas necesarias_

4. Haga clic en **Confirmar** en el lado derecho de la página, luego haga clic en Confirmar en up window

## Crear Build job
Ahora es el momento de crear el trabajo de automatización que transformará los códigos que ha creado en una imagen de contenedor y lo cargará en Oracle Cloud Infraestructure Registry.

1. En la barra izquierda, haga clic en Builds

2. Haga clic en + Crear trabajo en la parte inferior de la página.
![](./img/Build04.PNG)

3. Fill with the following information:
    - *Name*: Build
    - *Template*: < created on [Lab100](../Lab100/Lab100.md) >

4. Click on **Create**

5. On the **Git tab**, click on **Add Git** on the right corner of the page, thenselect **Git** in the dropdown menu

![](./img/Build05.PNG)

6. Select your repository on the **Repository** required field

7. On the **Steps tab**, click on **Add Step > Docker > Docker Login** 

8. Select OCIR as your **Registry Host**

![](./img/Build06.PNG)

9. Next step, click on **Add Step > Docker > Docker Build** 

10. Fill with the following information:
    - *Image Name*: < Storage Namespace collected on [Lab100](../Lab100/Lab100.md) >/pythonapp
    - *Source*: Context Root in Workspace

![](./img/Build07.PNG)

11. On the **Steps tab**, click on **Add Step > Docker > Docker Push** 

12. Save the job by clicking on **Save** at the top of the page


## Testing the job
In this step you will verify in both the log, and also on the Oracle Cloud infraestructure that the container image was sucessfully created and uploaded.

1. Click on **Build Now** to start the job

![](./img/Build08.PNG)

2. Click on **Build Log** to monitor the job execution

![](./img/Build09.PNG)

_NOTICE: This may take several minutes since it's the first job request.The build VM needs to turn on to execute the job steps_

3. Now to check on the Oracle Cloud Infraestructure, access the OCI console:
[Sign In](https://console.us-ashburn-1.oraclecloud.com/)

4. Input your **tenancy name**, then click on **Next**.

5. On the Oracle Cloud Account sign-in page, enter your Oracle Cloud account credentials, and click **Sign In**.

6. On the OCI Console, click on the **Menu icon** in the top-left corner.

7. Under **Developer Services**, and then select **Registry (OCIR)**.

![](./img/Build10.PNG)

8. Before leaving to the next lab, click on **latest** under **pythonapp** and copy the **Full Path** information to the notepad.

![](./img/Build11.PNG)

[<- Back](../README.md)
